generator publicclient {
    provider        = "prisma-client-js"
    output          = "../src/generated/prisma-public"
    previewFeatures = ["views", "multiSchema"]
}

datasource publicdb {
    provider = "postgresql"
    url      = env("DATABASE_URL")
    schemas  = ["public"]
}

// Do not remove, might be overridden by prisma db pull
view proposal {
    id                  String    @id
    receiptId           String    @map("receipt_id")
    proposalId          Int       @map("proposal_id")
    proposalTitle       String?   @map("proposal_title")
    proposalDescription String?   @map("proposal_description")
    proposalUrl         String?   @map("proposal_url")
    isApproved          Boolean   @map("is_approved")
    isRejected          Boolean   @map("is_rejected")
    hasVotes            Boolean   @map("has_votes")
    createdAt           DateTime  @map("created_at") @publicdb.Timestamp(6)
    creatorId           String    @map("creator_id")
    approvedAt          DateTime? @map("approved_at") @publicdb.Timestamp(6)
    approverId          String?   @map("approver_id")
    rejectedAt          DateTime? @map("rejected_at") @publicdb.Timestamp(6)
    rejecterId          String?   @map("rejecter_id")
    forVotingPower      Decimal   @map("for_voting_power")
    againstVotingPower  Decimal   @map("against_voting_power")
    abstainVotingPower  Decimal   @map("abstain_voting_power")

    @@map("proposals")
    @@schema("public")
}

// Do not remove, might be overridden by prisma db pull
view proposalVotingHistory {
    id                          String   @id
    receiptId                   String   @map("receipt_id")
    votedDate                   DateTime @map("voted_date") @publicdb.Date
    votedAt                     DateTime @map("voted_at") @publicdb.Timestamp(6)
    proposalId                  Int      @map("proposal_id")
    proposalName                String?  @map("proposal_name")
    voterId                     String   @map("voter_id")
    voteOption                  Int      @map("vote_option")
    votingPower                 Decimal? @map("voting_power")
    extraVenearBalance          Decimal  @map("extra_venear_balance")
    delegatorAccountId          String?  @map("delegator_account_id")
    delegatedNearBalance        Decimal  @map("delegated_near_balance")
    delegatedExtraVenearBalance Decimal  @map("delegated_extra_venear_balance")
    blockHash                   String   @map("block_hash")
    blockHeight                 Int      @map("block_height")

    @@map("proposal_voting_history")
    @@schema("public")
}

// Do not remove, might be overridden by prisma db pull
view registeredVoters {
    id                          String   @id
    receiptId                   String   @map("receipt_id")
    registeredDate              DateTime @map("registered_date") @publicdb.Date
    registeredAt                DateTime @map("registered_at") @publicdb.Timestamp(6)
    registeredVoterId           String   @map("registered_voter_id")
    hosContractAddress          String   @map("hos_contract_address")
    hasLockedUnlockedNear       Boolean  @map("has_locked_unlocked_near")
    isActivelyDelegating        Boolean  @map("is_actively_delegating")
    votingPowerFromDelegations  Decimal? @map("voting_power_from_delegations")
    votingPowerFromLocksUnlocks Decimal? @map("voting_power_from_locks_unlocks")
    initialVotingPower          Decimal? @map("initial_voting_power")
    currentVotingPower          Decimal? @map("current_voting_power")
    proposalParticipationRate   Decimal? @map("proposal_participation_rate")
    blockHeight                 BigInt   @map("block_height")
    blockHash                   String   @map("block_hash")

    @@map("registered_voters")
    @@schema("public")
}

// Do not remove, might be overridden by prisma db pull
view proposalNonVoters {
    id                String @id
    proposalId        Int    @map("proposal_id")
    registeredVoterId String @map("registered_voter_id")

    @@map("proposal_non_voters")
    @@schema("public")
}

// Do not remove, might be overridden by prisma db pull
view delegationEvents {
    id                     String   @id
    receiptId              String   @map("receipt_id")
    eventDate              DateTime @map("event_date") @publicdb.Date
    eventTimestamp         DateTime @map("event_timestamp") @publicdb.Timestamp(6)
    delegatorId            String   @map("delegator_id")
    delegateeId            String?  @map("delegatee_id")
    delegateMethod         String   @map("delegate_method")
    delegateEvent          String   @map("delegate_event")
    isLatestDelegatorEvent Boolean  @map("is_latest_delegator_event")
    nearAmount             Decimal? @map("near_amount")
    blockHeight            Int      @map("block_height")
    blockHash              String   @map("block_hash")

    @@map("delegation_events")
    @@schema("public")
}

// Do not remove, might be overridden by prisma db pull
view userActivities {
    id                 String   @id
    receiptId          String   @map("receipt_id")
    hosContractAddress String   @map("hos_contract_address")
    accountId          String   @map("account_id")
    eventDate          DateTime @map("event_date") @publicdb.Date
    eventTimestamp     DateTime @map("event_timestamp") @publicdb.Timestamp(6)
    methodName         String   @map("method_name")
    eventType          String   @map("event_type")
    eventStatus        String   @map("event_status")
    nearAmount         Decimal? @map("near_amount")
    lockedNearBalance  Decimal? @map("locked_near_balance")
    blockHeight        BigInt   @map("block_height")
    blockHash          String   @map("block_hash")

    @@map("user_activities")
    @@schema("public")
}

model blocks {
    height       BigInt   @id
    hash         String
    prev_hash    String
    author       String
    timestamp    DateTime @publicdb.Timestamp(6)
    gas_price    String
    total_supply String

    @@schema("public")
}

model chunks {
    height                 BigInt
    chunk_hash             String @id
    prev_block_hash        String
    outcome_root           String
    prev_state_root        String
    encoded_merkle_root    String
    encoded_length         BigInt
    height_created         BigInt
    height_included        BigInt
    shard_id               BigInt
    gas_used               BigInt
    gas_limit              BigInt
    validator_reward       String
    balance_burnt          String
    outgoing_receipts_root String
    tx_root                String
    author                 String

    @@schema("public")
}

model cursors {
    id        String  @id(map: "cursor_pk")
    cursor    String?
    block_num BigInt?
    block_id  String?

    @@schema("public")
}

model receipt_actions {
    id                String   @id
    block_height      BigInt
    receipt_id        String
    signer_account_id String
    signer_public_key String
    gas_price         String
    action_kind       String
    predecessor_id    String
    receiver_id       String
    block_hash        String
    chunk_hash        String
    author            String
    method_name       String
    gas               BigInt
    deposit           String
    args_base64       String
    action_index      Int
    block_timestamp   DateTime @publicdb.Timestamp(6)

    @@schema("public")
}

model receipts {
    height         BigInt
    block_hash     String
    chunk_hash     String
    receipt_id     String @id
    predecessor_id String
    receiver_id    String
    receipt_kind   String
    author         String

    @@schema("public")
}

model substreams_history {
    id         Int     @id @default(autoincrement())
    op         String? @publicdb.Char(1)
    table_name String?
    pk         String?
    prev_value String?
    block_num  BigInt?

    @@schema("public")
}

model execution_outcomes {
    receipt_id             String   @id
    block_height           BigInt
    block_hash             String
    chunk_hash             String
    shard_id               String
    gas_burnt              BigInt
    gas_used               Float
    tokens_burnt           Float
    executor_account_id    String
    status                 String
    outcome_receipt_ids    String[]
    executed_in_block_hash String
    logs                   String[]

    @@schema("public")
}
