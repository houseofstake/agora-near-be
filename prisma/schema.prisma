generator client {
  provider        = "prisma-client-js"
  output          = "../src/generated/prisma"
  previewFeatures = ["views"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// Do not remove, might be overridden by prisma db pull
view proposalVotingHistory {
  id                          String   @id
  receiptId                   String   @map("receipt_id")
  votedDate                   DateTime @map("voted_date") @db.Date
  votedAt                     DateTime @map("voted_at") @db.Timestamp(6)
  proposalId                  Int      @map("proposal_id")
  proposalName                String?   @map("proposal_name")
  voterId                     String   @map("voter_id")
  voteOption                  Int      @map("vote_option")
  votingPower                 Decimal?  @map("voting_power")
  extraVenearBalance          Decimal  @map("extra_venear_balance")
  delegatorAccountId          String?   @map("delegator_account_id")
  delegatedNearBalance        Decimal  @map("delegated_near_balance")
  delegatedExtraVenearBalance Decimal  @map("delegated_extra_venear_balance")
  blockHash                   String   @map("block_hash")
  blockHeight                 Int      @map("block_height")

  @@map("proposal_voting_history")
}

// Do not remove, might be overridden by prisma db pull
view registeredVoters {
  id                          String   @id
  receiptId                   String   @map("receipt_id")
  registeredDate              DateTime @map("registered_date") @db.Date
  registeredAt                DateTime @map("registered_at") @db.Timestamp(6)
  registeredVoterId           String   @map("registered_voter_id")
  hosContractAddress          String  @map("hos_contract_address")
  hasVoterLockedUnlockedNear  Boolean  @map("has_voter_locked_unlocked_near")
  currentVotingPower          Decimal?  @map("current_voting_power")
  initialVotingPower          Decimal?  @map("initial_voting_power")
  proposalParticipationRate   Decimal?  @map("proposal_participation_rate")
  blockHash                   String   @map("block_hash")
  blockHeight                 Int      @map("block_height")
  chunkHash                   String   @map("chunk_hash")

  @@map("registered_voters")
}

// Do not remove, might be overridden by prisma db pull
view delegationEvents {
  id                          String   @id
  receiptId                   String   @map("receipt_id")
  eventDate                   DateTime @map("event_date") @db.Date
  eventTimestamp              DateTime @map("event_timestamp") @db.Timestamp(6)
  delegatorId                 String   @map("delegator_id")
  delegateeId                 String?   @map("delegatee_id")
  delegateMethod              String   @map("delegate_method")
  nearAmount                  Decimal? @map("near_amount")
  blockHeight                 Int      @map("block_height")
  blockHash                   String   @map("block_hash")

  @@map("delegation_events")
}

model blocks {
  height       BigInt   @id
  hash         String
  prev_hash    String
  author       String
  timestamp    DateTime @db.Timestamp(6)
  gas_price    String
  total_supply String
}

model chunks {
  height                 BigInt
  chunk_hash             String @id
  prev_block_hash        String
  outcome_root           String
  prev_state_root        String
  encoded_merkle_root    String
  encoded_length         BigInt
  height_created         BigInt
  height_included        BigInt
  shard_id               BigInt
  gas_used               BigInt
  gas_limit              BigInt
  validator_reward       String
  balance_burnt          String
  outgoing_receipts_root String
  tx_root                String
  author                 String
}

model cursors {
  id        String  @id(map: "cursor_pk")
  cursor    String?
  block_num BigInt?
  block_id  String?
}

model receipt_actions {
  id                String   @id
  block_height      BigInt
  receipt_id        String
  signer_account_id String
  signer_public_key String
  gas_price         String
  action_kind       String
  predecessor_id    String
  receiver_id       String
  block_hash        String
  chunk_hash        String
  author            String
  method_name       String
  gas               BigInt
  deposit           String
  args_base64       String
  action_index      Int
  block_timestamp   DateTime @db.Timestamp(6)
}

model receipts {
  height         BigInt
  block_hash     String
  chunk_hash     String
  receipt_id     String @id
  predecessor_id String
  receiver_id    String
  receipt_kind   String
  author         String
}

model substreams_history {
  id         Int     @id @default(autoincrement())
  op         String? @db.Char(1)
  table_name String?
  pk         String?
  prev_value String?
  block_num  BigInt?
}

model execution_outcomes {
  receipt_id             String   @id
  block_height           BigInt
  block_hash             String
  chunk_hash             String
  shard_id               String
  gas_burnt              BigInt
  gas_used               Float
  tokens_burnt           Float
  executor_account_id    String
  status                 String
  outcome_receipt_ids    String[]
  executed_in_block_hash String
}

model delegate_statements {
  address          String  @id
  signature        String
  statement        String
  publicKey        String
  message          String
  topIssues        Json?
  agreeCodeConduct Boolean
  twitter          String?
  discord          String?
  email            String?
  warpcast         String?

  @@index([email], map: "idx_delegate_statements_email")
}
